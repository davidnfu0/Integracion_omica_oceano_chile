---
title: PCA
jupyter: 
  kernelspec:
    name: "MOFA"
    language: "python"
    display_name: "MOFA"
---


```{python}
import pandas as pd
import numpy as np
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt
```

```{python}
data_dir = "../data/"
M_all = pd.read_csv(f"{data_dir}M_all.csv", index_col=0)
M_all.head(3)
```

```{python}
pca = PCA(n_components=15)
pca.fit(M_all)
pca_transformed = pca.transform(M_all)
pca_dict = dict()
for i in range(15):
    pca_dict[i + 1] = pca_transformed[:, : i + 1]
pca_explained_variance = np.cumsum(pca.explained_variance_ratio_)
```

```{python}
M_pca_pd = pd.DataFrame(pca_transformed, index=M_all.index)
M_pca_pd.columns = [f"PCA{i + 1}" for i in range(M_pca_pd.shape[1])]
M_pca_pd.to_csv(f"{data_dir}M_pca.csv")
```

```{python}
plt.figure(figsize=(10, 6))
plt.plot(pca_dict.keys(), pca_explained_variance, marker="o")
plt.title("PCA Explained Variance")
plt.xticks(list(pca_dict.keys()))
plt.xlabel("Number of Components")
plt.ylabel("Explained Variance")
plt.grid()
plt.show()
```

___

